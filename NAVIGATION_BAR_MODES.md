# 菜单栏和导航栏显示模式功能

## 功能概述

为 FlowTask 应用添加了完整的外观自定义功能，包括：
1. **菜单栏图标自定义** - 系统图标、自定义文字或表情符号（新增！）
2. **菜单栏显示内容** - 任务数量、今日剩余、进度等
3. **贴图窗口导航栏** - 应用内显示模式

所有设置都在新增的"外观"标签页中统一管理。

---

## 🎨 一、外观设置（新增独立标签页）

### 菜单栏图标自定义

用户可以自由选择菜单栏图标的样式：

#### 1. 系统图标模式（默认）
- **说明**: 使用 macOS SF Symbols 系统图标
- **预设图标**: 提供 20+ 常用图标快速选择
- **自定义**: 支持输入任何 SF Symbols 图标名称
- **示例**: `checkmark.circle`, `list.bullet`, `star.fill` 等

**常用图标库**:
```
✓ checkmark.circle      📝 square.and.pencil
📋 list.bullet          📅 calendar
⭐ star                 ❤️ heart
🚩 flag                 🔖 bookmark
✈️ paperplane           📥 tray
```

#### 2. 自定义文字模式
- **说明**: 使用 1-2 个自定义字符
- **限制**: 最多 2 个字符（保持简洁）
- **建议**: 使用简短符号或字母
- **示例**: `✓`, `T`, `📝`, `Do` 等

#### 3. 表情符号模式
- **说明**: 使用表情符号作为图标
- **预设表情**: 提供 24+ 常用表情快速选择
- **自定义**: 可以输入任何表情符号
- **示例**: `✅`, `📝`, `🎯`, `🚀`, `⭐` 等

**常用表情库**:
```
✓ ✔️ ✅ ☑️    (对勾系列)
📝 📋 📌 📍    (文档系列)
⭐ 🌟 💫 ✨    (星星系列)
🎯 🎨 🎭 🎪    (目标系列)
🔥 💡 ⚡ 🌈    (能量系列)
🚀 🎉 🎊 🎈    (庆祝系列)
```

### 实时预览
- 设置界面右上角显示实时预览效果
- 格式：`[图标] [内容]`
- 例如：`✓ 5`, `📝 3`, `🚀 75%`

---

## 📊 二、菜单栏显示内容

### 可用的显示模式

#### 1. 任务数量模式 (默认)
- **显示效果**: `✓ 5`
- **说明**: 显示待完成任务的总数
- **适用场景**: 快速了解待办任务数量
- **动态更新**: 任务完成后实时更新

#### 2. 今日剩余模式
- **显示效果**: `✓ 3` 或 `✓ ✓`（全部完成）
- **说明**: 显示今日截止的剩余任务数
- **适用场景**: 专注于今日任务的完成情况
- **智能判断**: 自动识别今日任务范围

#### 3. 完成进度模式
- **显示效果**: `✓ 75%`
- **说明**: 显示任务完成百分比
- **适用场景**: 关注整体任务完成进度
- **计算方式**: 已完成任务数 / 总任务数 × 100%

#### 4. 问候图标模式
- **显示效果**: 根据时间显示不同图标
  - 5:00-12:00: `☀️` (早晨)
  - 12:00-14:00: `🌤️` (中午)
  - 14:00-18:00: `🌥️` (下午)
  - 18:00-22:00: `🌙` (晚上)
  - 22:00-5:00: `🌜` (深夜)
- **说明**: 根据当前时间显示温馨图标
- **适用场景**: 增加人性化体验，时间感知

#### 5. 简洁模式
- **显示效果**: `✓`（只显示图标）
- **说明**: 不显示任何文字，极简风格
- **适用场景**: 喜欢极简风格的用户

---

## 🪟 三、贴图窗口导航栏显示模式

### 可用的显示模式

#### 1. 任务数量模式 (默认)
- **显示内容**: `Tasks · 3`
- **说明**: 显示待完成任务的总数

#### 2. 今日剩余模式
- **显示内容**: `📅 今日剩余 5` 或 `📅 今日剩余 ✓`
- **说明**: 显示今日截止的剩余任务数

#### 3. 任务进度模式
- **显示内容**: `📊 15/20 (75%)`
- **说明**: 显示已完成/总任务数和完成百分比

#### 4. 问候语模式
- **显示内容**: 根据时间显示不同问候
  - 5:00-12:00: `🌅 早上好`
  - 12:00-14:00: `☀️ 中午好`
  - 14:00-18:00: `🌤️ 下午好`
  - 18:00-22:00: `🌙 晚上好`
  - 22:00-5:00: `🌙 夜深了`

#### 5. 简洁模式
- **显示内容**: `Tasks`
- **说明**: 只显示标题，不显示额外信息

---

## ⚙️ 如何设置？

### 设置路径
1. 打开应用主窗口
2. 点击左侧导航栏的 "设置" 按钮
3. 选择 **"外观"** 分类（第一个标签）
4. 配置你喜欢的样式：
   - **菜单栏图标** - 选择图标类型和具体图标
   - **菜单栏显示内容** - 选择显示模式
5. 设置会立即生效，无需重启

### 设置界面特点
- 🎯 **独立标签页**：外观设置独立成一个标签
- 👁️ **实时预览**：右上角显示当前效果预览
- 🎨 **可视化选择**：图标和表情以网格形式展示
- 📝 **详细说明**：每个选项都有图标、名称和描述
- ⚡ **即时生效**：选择后立即应用，无需重启

---

## 💡 使用建议

### 图标选择建议
- **工作场景**: 使用系统图标 `checkmark.circle` 或 `list.bullet`，专业简洁
- **个性化**: 使用表情符号 `🚀` 或 `⭐`，增加趣味性
- **极简风格**: 使用自定义文字 `✓` 或 `T`，保持简洁

### 显示模式搭配
- **工作日**: 图标 `📝` + 今日剩余模式
- **项目冲刺**: 图标 `🚀` + 完成进度模式
- **日常使用**: 图标 `✓` + 任务数量模式
- **极简主义**: 图标 `✓` + 简洁模式

### 创意组合示例
```
🚀 5      - 火箭 + 任务数量（充满动力）
📝 75%    - 笔记 + 完成进度（工作进展）
⭐ 3      - 星星 + 今日剩余（今日目标）
✓         - 对勾 + 简洁模式（极简风格）
🎯 ☀️     - 靶心 + 问候图标（时间感知）
```

---

## 🔧 技术实现

### 新增枚举类型

#### 菜单栏图标类型
```swift
enum MenuBarIconType: String, CaseIterable, Codable {
    case systemIcon = "system_icon"         // 系统图标
    case customText = "custom_text"         // 自定义文字
    case emoji = "emoji"                    // 表情符号
}
```

#### 菜单栏显示模式
```swift
enum MenuBarDisplayMode: String, CaseIterable, Codable {
    case taskCount = "task_count"           // 任务数量
    case todayRemaining = "today_remaining" // 今日剩余
    case progress = "progress"              // 完成进度
    case greeting = "greeting"              // 问候图标
    case simple = "simple"                  // 简洁模式
}
```

### 设置管理
- 使用 `@AppStorage` 持久化用户选择
- 图标类型：`menuBarIconType`
- 系统图标名称：`menuBarSystemIcon`
- 自定义文字：`menuBarCustomText`
- 显示模式：`menuBarDisplayMode`

### 动态更新机制
- **图标更新**：`updateStatusBarIcon()` 方法
- **内容更新**：`updateStatusBarTitle()` 方法
- **通知机制**：使用 `NotificationCenter` 通知更新
- **实时监听**：监听设置变化和数据变化

---

## 📱 界面布局

### 设置标签页顺序
1. **外观** 🎨 - 菜单栏图标和显示（最高优先级）
2. **任务** ✓ - 任务相关设置
3. **日历** 📅 - 日历订阅设置
4. **桌面贴图** 🪟 - 贴图窗口和悬浮球
5. **关于** ℹ️ - 应用信息

### 外观设置布局
```
┌─────────────────────────────────────┐
│ 外观                                │
├─────────────────────────────────────┤
│ 菜单栏图标              [预览: ✓ 5] │
│ ├─ 系统图标 ✓                       │
│ ├─ 自定义文字                       │
│ └─ 表情符号                         │
│                                     │
│ [图标选择网格]                      │
│                                     │
│ ─────────────────────────────────  │
│                                     │
│ 菜单栏显示内容                      │
│ ├─ 任务数量 ✓                       │
│ ├─ 今日剩余                         │
│ ├─ 完成进度                         │
│ ├─ 问候图标                         │
│ └─ 简洁模式                         │
└─────────────────────────────────────┘
```

---

## 🎁 特色功能

### 1. 智能图标库
- 预设 20+ 常用系统图标
- 预设 24+ 常用表情符号
- 支持搜索和自定义输入

### 2. 实时预览
- 设置界面实时显示效果
- 所见即所得的体验

### 3. 字符限制
- 自定义文字最多 2 个字符
- 自动截断超长输入
- 保持菜单栏简洁美观

### 4. 灵活组合
- 图标 × 显示模式 = 15 种组合
- 支持完全自定义的个性化设置

---

## 🚀 未来扩展

可以考虑添加更多功能：
- 自定义图标颜色
- 动态图标（根据任务状态变化）
- 图标动画效果
- 更多预设主题
- 导入/导出配置
- 社区图标库
